<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê°ìë³´ë¦¬ ê°€ê³µê³µì¥</title>
  <style>
    body {
      background: url('https://byungil-cho.github.io/OrcaX/farm-101.png') no-repeat center center fixed;
      background-size: cover;
      color: white;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 1rem;
    }
    .box {
      background: rgba(0,0,0,0.6);
      padding: 1rem 2rem;
      border-radius: 12px;
      max-width: 800px;
      margin: auto;
    }
    h2 { text-align: center; }
    label, select, button {
      display: block;
      margin: 1rem auto;
      font-size: 1rem;
    }
    button {
      padding: 0.5rem 1rem;
      border-radius: 8px;
      background-color: #4CAF50;
      border: none;
      color: white;
      cursor: pointer;
    }
    .status {
      background: rgba(255,255,255,0.8);
      color: black;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
    }
    .links {
      text-align: center;
      margin-top: 2rem;
    }
    .links a {
      color: #00e6e6;
      margin: 0 1rem;
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="box">
    <h2>ğŸ¥” ê°ì/ë³´ë¦¬ ê°€ê³µê³µì¥</h2>
    <div class="status">
      <p>ğŸ‘¤ ë‹‰ë„¤ì„: <span id="nickname">-</span></p>
      <p>ğŸ  ë†ì¥ì´ë¦„: <span id="farmName">-</span></p>
      <p>âš¡ ì „ì› ìƒíƒœ: <span id="serverStatus">ë°œê²¬ì¤‘...</span></p>
      <p>ğŸ’² í† í°: <span id="tokens">0</span></p>
      <p>ğŸŒ¾ ì”¨ê°ì: <span id="potatoSeeds">0</span> / ì”¨ë³´ë¦¬: <span id="barleySeeds">0</span></p>
    </div>

    <label for="type">ê°€ê³µí•  ì›ì¬ë£Œë¥¼ ì„ íƒí•˜ì„¸ìš”:</label>
<select id="type">
  <option value="ê°ì">ğŸ¥” ê°ì</option>
  <option value="ë³´ë¦¬">ğŸŒ¾ ë³´ë¦¬</option>
</select>

<label for="product">ê°€ê³µí•  í’ˆëª©ì„ ì…ë ¥í•˜ì„¸ìš”:</label>
<input type="text" id="product" placeholder="ì˜ˆ: ê°ìì¹©, ê°ìì „, ë³´ë¦¬ì¼€ì´í¬ ë“±" />
    <button onclick="processProduct()">ê°€ê³µí•˜ê¸°</button>
    <p id="message"></p>

    <div class="links">
      <a href="gamja-farm.html">ğŸŒ± ê°ìë†ì¥ìœ¼ë¡œ</a>
      <a href="gamja-shop.html">ğŸ›’ ì”¨ì•—ìƒì ìœ¼ë¡œ</a>
      <a href="index9.html">ğŸ  ë©”ì¸í˜ì´ì§€ë¡œ</a>
    </div>
  </div>

  <script>
    function updateUserData() {
      document.getElementById("nickname").textContent = localStorage.getItem("nickname") || "-";
      document.getElementById("farmName").textContent = localStorage.getItem("farmName") || "-";
      document.getElementById("tokens").textContent = localStorage.getItem("tokens") || 0;
      document.getElementById("potatoSeeds").textContent = localStorage.getItem("ì”¨ê°ì") || 0;
      document.getElementById("barleySeeds").textContent = localStorage.getItem("ì”¨ë³´ë¦¬") || 0;
    }

    function checkServer() {
      fetch("https://climbing-wholly-grouper.jp.ngrok.io/")
        .then(() => {
          document.getElementById("serverStatus").textContent = "ğŸŸ¢ ì—°ê²°ë˜ì—ˆìŒ";
        })
        .catch(() => {
          document.getElementById("serverStatus").textContent = "ğŸ”´ ê±°ë“­";
        });
    }

    function processProduct() {
  const product = document.getElementById("product").value;
  const type = document.getElementById("type").value;
  const resourceKey = type === "ê°ì" ? "ê°ì" : "ë³´ë¦¬";
  let quantity = parseInt(localStorage.getItem(resourceKey) || 0);
  if (quantity <= 0) {
    document.getElementById("message").textContent = `${type}ê°€ ë¶€ì¡±í•˜ì—¬ ê°€ê³µí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`;
    return;
  }
  quantity -= 1;
  localStorage.setItem(resourceKey, quantity);

  const now = new Date();
  const expire = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000);

  let storage = JSON.parse(localStorage.getItem("processed") || '{}');
  if (!storage[product]) {
    storage[product] = [];
  }
  storage[product].push({ quantity: 1, expire: expire.toISOString() });
  localStorage.setItem("processed", JSON.stringify(storage));

  document.getElementById("message").textContent = `${product} 1ê°œ ê°€ê³µ ì™„ë£Œ (ìœ í†µê¸°í•œ: ${expire.toLocaleDateString()})`;
}');
      if (!storage[product]) {
        storage[product] = [];
      }
      storage[product].push({ quantity: 1, expire: expire.toISOString() });
      localStorage.setItem("processed", JSON.stringify(storage));

      document.getElementById("message").textContent = `${product} 1ê°œ ê°€ê³µ ì™„ë£Œ (ìœ í†µê¸°í•œ: ${expire.toLocaleDateString()})`;
    }

    updateUserData();
    checkServer();
  </script>
</body>
</html>
