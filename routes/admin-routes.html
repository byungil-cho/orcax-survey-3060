<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ğŸŒ½ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
    h1 { color: #333; }
    section { background: #fff; padding: 15px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    input, button { margin: 5px 0; padding: 6px; }
    button { cursor: pointer; }
    pre { background: #222; color: #0f0; padding: 10px; border-radius: 6px; overflow-x: auto; }
  </style>
</head>
<body>
  <h1>ğŸŒ½ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h1>

  <!-- ì„¤ì • ë³€ê²½ -->
  <section>
    <h2>ì„¤ì • ë³€ê²½</h2>
    <input id="cfgCategory" placeholder="ì¹´í…Œê³ ë¦¬ (ex: harvest)" />
    <input id="cfgKey" placeholder="ì„¤ì • í‚¤ (ex: rate)" />
    <input id="cfgValue" placeholder="ì„¤ì • ê°’ (ex: 1.2)" />
    <button onclick="setConfig()">ì„¤ì • ë³€ê²½</button>
  </section>

  <!-- ëŒ€ì¶œ ê´€ë¦¬ -->
  <section>
    <h2>ëŒ€ì¶œ ê´€ë¦¬</h2>
    <input id="loanUser" placeholder="ìœ ì € ID" />
    <input id="loanAmount" placeholder="ìƒí™˜ ê¸ˆì•¡" />
    <button onclick="forceRepay()">ëŒ€ì¶œ ê°•ì œ ìƒí™˜</button>
  </section>

  <!-- NFT ì§€ê¸‰ -->
  <section>
    <h2>NFT ì§€ê¸‰</h2>
    <input id="nftUser" placeholder="ìœ ì € ID" />
    <input id="nftIndex" placeholder="ë¦¬ì›Œë“œ ì¸ë±ìŠ¤ (ex: 0)" />
    <input id="nftWallet" placeholder="ì§€ê°‘ ì£¼ì†Œ" />
    <button onclick="grantNFT()">NFT ì§€ê¸‰</button>
  </section>

  <!-- ë³´ìƒ ì§€ê¸‰ -->
  <section>
    <h2>ìˆ˜ë™ ë³´ìƒ ì§€ê¸‰</h2>
    <input id="rewardUser" placeholder="ìœ ì € ID" />
    <input id="rewardType" placeholder="ë³´ìƒ ì¢…ë¥˜ (ex: token)" />
    <input id="rewardAmount" placeholder="ë³´ìƒ ê°œìˆ˜" />
    <button onclick="manualReward()">ë³´ìƒ ì§€ê¸‰</button>
  </section>

  <!-- ì§€ê°‘ ë³€ê²½ -->
  <section>
    <h2>ì§€ê°‘ ì£¼ì†Œ ë³€ê²½</h2>
    <input id="walletUser" placeholder="ìœ ì € ID" />
    <input id="newWallet" placeholder="ìƒˆ ì§€ê°‘ ì£¼ì†Œ" />
    <button onclick="updateWallet()">ì§€ê°‘ ë³€ê²½</button>
  </section>

  <!-- ë¡œê·¸ ì¡°íšŒ -->
  <section>
    <h2>ê´€ë¦¬ ë¡œê·¸</h2>
    <button onclick="getLogs()">ë¡œê·¸ ì¡°íšŒ</button>
    <pre id="logResult">[ë¡œê·¸ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤]</pre>
  </section>

  <!-- ëŒ€ê¸° ë³€ê²½ ì ìš© -->
  <section>
    <h2>ëŒ€ê¸° ë³€ê²½ ì ìš© (08:00 ìˆ˜ë™ í…ŒìŠ¤íŠ¸)</h2>
    <button onclick="applyChanges()">ë³€ê²½ì‚¬í•­ ì ìš©</button>
  </section>

  <script>
    const API = "http://localhost:3060/api/admin";

    async function setConfig() {
      const res = await fetch(`${API}/config`, {
        method: "POST", headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          category: document.getElementById("cfgCategory").value,
          key: document.getElementById("cfgKey").value,
          value: document.getElementById("cfgValue").value
        })
      });
      alert(await res.text());
    }

    async function forceRepay() {
      const res = await fetch(`${API}/loan/repay`, {
        method: "POST", headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          userId: document.getElementById("loanUser").value,
          amount: document.getElementById("loanAmount").value
        })
      });
      alert(await res.text());
    }

    async function grantNFT() {
      const res = await fetch(`${API}/nft/grant`, {
        method: "POST", headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          userId: document.getElementById("nftUser").value,
          rewardIndex: parseInt(document.getElementById("nftIndex").value),
          walletAddr: document.getElementById("nftWallet").value
        })
      });
      alert(await res.text());
    }

    async function manualReward() {
      const res = await fetch(`${API}/reward/manual`, {
        method: "POST", headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          userId: document.getElementById("rewardUser").value,
          type: document.getElementById("rewardType").value,
          amount: parseInt(document.getElementById("rewardAmount").value)
        })
      });
      alert(await res.text());
    }

    async function updateWallet() {
      const res = await fetch(`${API}/user/wallet`, {
        method: "POST", headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          userId: document.getElementById("walletUser").value,
          newWallet: document.getElementById("newWallet").value
        })
      });
      alert(await res.text());
    }

    async function getLogs() {
      const res = await fetch(`${API}/logs`);
      const data = await res.json();
      document.getElementById("logResult").innerText = JSON.stringify(data, null, 2);
    }

    async function applyChanges() {
      const res = await fetch(`${API}/apply`, { method: "POST" });
      alert(await res.text());
    }
  </script>
</body>
</html>
